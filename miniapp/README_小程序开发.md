# 小程序版本开发指南

## 快速开始

### 1. 在微信开发者工具中打开项目

1. 打开微信开发者工具
2. 选择"导入项目"
3. 选择 `miniapp` 目录
4. 填写 AppID（如果没有，选择"测试号"）
5. 点击"导入"

### 2. 配置云开发环境

在 `app.js` 中，将环境ID替换为你的云开发环境ID：
```javascript
wx.cloud.init({
  env: 'cloud1-0g37deo4d3db8310', // 替换为你的环境ID
  traceUser: true,
});
```

**重要**：确保这个环境ID和 Web 版本使用的是同一个云开发环境，这样数据才能共享。

### 3. 运行项目

点击微信开发者工具的"编译"按钮，即可在模拟器中查看效果。

## 项目结构说明

```
miniapp/
├── app.js              # 小程序入口，初始化云开发
├── app.json            # 全局配置，页面路由
├── app.wxss            # 全局样式
├── pages/              # 页面目录
│   ├── login/          # 登录页
│   │   ├── login.js
│   │   ├── login.wxml
│   │   ├── login.wxss
│   │   └── login.json
│   ├── home/           # 首页（活动列表）
│   ├── activity/       # 活动相关
│   │   ├── create.js   # 创建/编辑活动
│   │   └── detail.js   # 活动详情（账单列表+结算）
│   └── bill/           # 账单相关
│       └── edit.js     # 添加/编辑账单
├── utils/              # 工具函数
│   └── db.js           # 数据库操作函数
└── project.config.json # 项目配置
```

## 功能说明

### ✅ 已实现的功能

1. **登录/注册** - 用户输入用户名即可登录
2. **活动列表** - 显示用户参与的所有活动
3. **创建/编辑活动** - 创建新活动或编辑已有活动
4. **活动详情** - 包含两个Tab：
   - **账单Tab**：显示该活动的所有账单，支持添加、查看、删除
   - **结算Tab**：显示成员余额和总支出统计
5. **添加/编辑账单** - 支持设置金额、名称、时间、付款人、参与成员权重等

### 🔄 与 Web 版本的差异

1. **页面跳转**：小程序使用 `wx.navigateTo()` 进行页面跳转，而不是单页应用
2. **数据绑定**：使用 `this.setData()` 更新数据，WXML 自动更新
3. **样式单位**：使用 `rpx`（响应式像素）而不是 `px`
4. **组件**：使用小程序原生组件（如 `picker`、`radio-group` 等）

## 开发注意事项

### 1. 云开发环境ID

确保 `app.js` 中的环境ID正确，并且和 Web 版本使用同一个环境。

### 2. 数据库权限

确保数据库集合的权限设置正确：
- `activities`：所有用户可读，仅创建者可写
- `bills`：所有用户可读，仅创建者可写
- `users`：所有用户可读，仅创建者可写
- `groups`：所有用户可读，仅创建者可写

### 3. 基础库版本

建议使用 2.2.3 或以上版本，以确保云开发功能正常。

### 4. 测试

- **模拟器测试**：在微信开发者工具的模拟器中测试基本功能
- **真机测试**：使用"预览"功能在真机上测试，某些功能（如云开发）需要在真机上才能完全正常

## 下一步优化建议

1. **添加下拉刷新**：在活动详情页和账单列表页添加下拉刷新功能
2. **优化样式**：根据小程序设计规范优化UI
3. **错误处理**：完善错误提示和异常处理
4. **性能优化**：优化数据加载和渲染性能
5. **添加分享功能**：支持分享活动给其他用户

## 常见问题

### Q: 云开发初始化失败？
A: 检查 `app.js` 中的环境ID是否正确，以及是否在微信开发者工具中正确配置了云开发。

### Q: 数据库查询失败？
A: 检查数据库集合的权限设置，确保当前用户有读取权限。

### Q: 页面跳转失败？
A: 检查 `app.json` 中的页面路径是否正确。

### Q: 样式显示异常？
A: 检查是否使用了小程序不支持的CSS属性，某些Web CSS属性在小程序中不支持。

## 需要帮助？

如果遇到问题，可以：
1. 查看微信小程序官方文档：https://developers.weixin.qq.com/miniprogram/dev/framework/
2. 查看云开发文档：https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html
3. 查看项目中的 `小程序移植指南.md` 了解详细的移植步骤
