<!--pages/activity/create.wxml-->
<view class="container">
  <view class="form">
    <view class="form-item">
      <text class="label">活动名称</text>
      <input class="input" type="text" placeholder="例如：周末聚餐" value="{{name}}" bindinput="onNameInput" maxlength="20" />
    </view>
    
    <view class="form-item">
      <text class="label">活动类型</text>
      <view class="type-tags">
        <view wx:for="{{commonTypes}}" wx:key="*this" class="type-tag {{type === item ? 'active' : ''}}" bindtap="selectType" bindlongpress="deleteType" data-type="{{item}}">
          {{item}}
        </view>
      </view>
      <input class="input" type="text" placeholder="或输入新类型" value="{{type}}" bindinput="onTypeInput" bindblur="onTypeBlur" maxlength="10" />
    </view>
    
    <view class="form-item">
      <text class="label">参与成员（<text class="label-highlight">输入姓名，每行一个</text>）</text>
      <view class="hint">提示：创建者（{{creator}}）会自动添加在第一位，且不可删除</view>
      <textarea class="textarea textarea-members" placeholder="每行输入一个成员姓名" value="{{membersText}}" bindinput="onMembersInput" />
    </view>
    
    <view class="form-item">
      <text class="label">备注</text>
      <!-- 显示模式：格式化显示默认备注 -->
      <view wx:if="{{!remarkEditing && !isEdit && remark}}" class="remark-display" bindtap="startEditRemark">
        <text class="remark-text"><text class="remark-highlight">默认方式</text>：A B C 每次费用轮流付款，长期会平衡，也可以通过 结算 ，线下转账强制平衡。\n<text class="remark-highlight">打平伙模式</text>：A B C 提前转到A 那里，A 保管费用，每次费用A 来付款，费用结算页面可以看到当前余额，如果某一个人余额为负，则应自觉去A那里充值。</text>
        <text class="remark-edit-hint">点击编辑</text>
      </view>
      <!-- 编辑模式：使用textarea -->
      <textarea wx:else class="textarea textarea-remark" placeholder="可选" value="{{remark}}" bindinput="onRemarkInput" auto-height="{{true}}" />
    </view>
    
    <view wx:if="{{showPrepaidOption}}" class="form-item">
      <view class="switch-item">
        <text class="switch-label">打平伙</text>
        <switch checked="{{isPrepaid}}" bindchange="togglePrepaid" disabled="{{isEdit && originalIsPrepaid}}" />
      </view>
      <view wx:if="{{isEdit && originalIsPrepaid}}" class="switch-hint">创建时已选择打平伙，不可修改</view>
    </view>
    
    <view wx:if="{{isPrepaid}}" class="form-item">
      <text class="label">保管人员</text>
      <view class="keeper-tags">
        <view wx:for="{{keeperList}}" wx:key="name" class="keeper-tag {{keeper === item.name ? 'active' : ''}}" bindtap="selectKeeper" data-name="{{item.name}}">
          {{item.name}}
        </view>
      </view>
    </view>
    
    <button class="btn btn-full" bindtap="saveActivity">{{isEdit ? '更新' : '创建'}}</button>
  </view>
</view>


